<script type="text/template" id="sidebar-template">
    <div class="wrap_profile">
        <a href="#" class="link_menu">
            <span class="ico_addressbook ico_menu">메뉴</span>
        </a>
        <div class="ico_profile">
            <a href="#" class="link_account">
                <span class="screen_out">계정 정보</span>
            </a>
            <span class="thumb_profile"
                  style="background-image: url(&quot;https://k.kakaocdn.net/dn/tGFOv/btrfbPDXBEi/QjzfBBc6v2noQArlp97ia1/img_110x110.jpg&quot;);"></span>
            <svg class="ico_obj" width="160" height="160px" viewBox="0 0 160 160" version="1.1"
                 xmlns="http://www.w3.org/2000/svg">
                <path class="ico_path"
                      d="M170,-10 L170,170 L-10,170 L-10,-10 L170,-10 Z M80,0 C20.5777778,0 0,20.5777778 0,80 C0,139.422222 20.5777778,160 80,160 C139.422222,160 160,139.422222 160,80 C160,20.5777778 139.422222,0 80,0 Z"
                      stroke-width="0"></path>
                <path class="obj_stroke"
                      d="M160,80 C160,139.422222 139.422222,160 80,160 C20.5777778,160 0,139.422222 0,80 C0,20.5777778 20.5777778,0 80,0 C139.422222,0 160,20.5777778 160,80 Z"
                      fill="none"></path>
            </svg>
        </div>
    </div>
    <nav id="kakaoGnb" style="user-select: none;">
        <h2 class="screen_out">메뉴</h2>
        <div class="box_add">
            <button type="button" class="btn_add">
                <span class="ico_addressbook ico_add"></span><span class="txt_add">주소추가</span>
            </button>
        </div>
        <div class="box_menu">
            <ul class="list_menu">
                <li class="item_current">
                    <a class="link_menu" href="" id="all">
                        <span class="ico_menu"><span class="ico_addressbook ico_all"></span></span>
                        <span class="txt_menu">전체</span>
                        <span class="num_count">1</span>
                    </a>
                </li>
                <li class="">
                    <a class="link_menu" href="recently" id="recently">
                        <span class="ico_menu">
                            <span class="ico_addressbook ico_recent"></span>
                        </span>
                        <span class="txt_menu">최근 이용한 연락처</span>
                        <span class="num_count">2</span>
                    </a>
                </li>

                <li class="">
                    <a class="link_menu" href="important" id="important">
                        <span class="ico_menu"><span class="ico_addressbook ico_star"></span></span>
                        <span class="txt_menu">중요한 연락처</span>
                        <span class="num_count">0</span>
                    </a>
                </li>
            </ul>
        </div>

        <div class="box_menu box_accordion box_open">
            <button type="button" class="btn_accordion">그룹<span class="ico_addressbook ico_arr"></span></button>

            <!-- group-template -->
            <div id="groupRegion"></div>
            <!-- // group-template -->

            <div class="wrap_edit wrap_edit2">
                <button type="button" class="btn_edit btn_new">
                    <span class="ico_addressbook ico_new"></span><span class="txt_btn">새 그룹 만들기</span>
                </button>
                <button type="button" class="btn_edit btn_manage">
                    <span class="ico_addressbook ico_manage"></span><span class="txt_btn">그룹관리</span>
                </button>
            </div>
        </div>

        <div class="box_menu">
            <ul class="list_menu">
                <li>
                    <a class="link_menu link_trash" href="#trash">
                        <span class="ico_menu"><span class="ico_addressbook ico_trash"></span></span><span
                            class="txt_menu">휴지통</span>
                    </a>
                    <button type="button" class="btn_recycle">비우기</button>
                </li>
                <li class="item_pc">
                    <a class="link_menu" href="#import">
                        <span class="ico_menu"><span class="ico_addressbook ico_import"></span></span>
                        <span class="txt_menu">주소록 가져오기</span>
                    </a>
                </li>
                <li class="item_pc">
                    <a class="link_menu" href="#export">
                        <span class="ico_menu"><span class="ico_addressbook ico_export"></span></span>
                        <span class="txt_menu">주소록 내보내기</span></a>
                </li>
                <li class="item_mobile">
                    <% var noticeURL = 'https://mail-notice.kakao.com/addrbook/en/main'; %>
                    <a href="<%- noticeURL %>" target="_blank" rel="noreferrer" class="link_menu">
						<span class="ico_menu">
							<span class="ico_addressbook ico_notice"></span>
						</span>
                        <span class="txt_menu">공지사항</span><span class="ico_addressbook ico_new2">new</span>
                    </a>
                </li>
                <li class="item_mobile">
                    <% var helpURL = 'https://cs.kakao.com/helps?service=156&amp;category=521&amp;locale=en'; %>
                    <a href="<%- helpURL %>" target="_blank" rel="noreferrer" class="link_menu">
						<span class="ico_menu">
							<span class="ico_addressbook ico_cs"></span>
						</span>
                        <span class="txt_menu">고객센터/도움말</span>
                    </a>
                </li>
            </ul>
        </div>
    </nav>
    <div id="groupLayerRegion"></div>
    <div id="alertLayerRegion"></div>
    <div id="toastLayerRegion"></div>
    <div id="toastFooterLayerRegion"></div>
    <div id="groupRemoveLayerRegion"></div>
</script>

<!-- <li style:'border-top: 0px; padding: 0px'> -->
<script type="text/template" id="group-item-template">
    <a class="link_menu" href="groups/<%- group.id %>">
			<span class="ico_menu">
				<span class="ico_addressbook ico_group"></span>
			</span>
        <span class="txt_menu"><%- group.name %></span>
        <span class="num_count"><%- group.contactsCount || 0 %></span>
    </a>
    <div class="wrap_edit" style="top: 3px;">
        <button type="button" class="btn_edit btn_modify"><span class="ico_addressbook ico_modify">수정</span></button>
        <button type="button" class="btn_edit btn_del"><span class="ico_addressbook ico_del">삭제</span></button>
    </div>
</script>

<script type="text/template" id="group-layer-template">
    <div class="layer_head">
        <strong class="tit_layer">
            <label for="tfNewGroup"><%- isNew ? '새 그룹 만들기' : '그룹수정' %></label>
        </strong>
    </div>
    <div class="layer_body">
        <form id="frmNewGroup" action="#">
            <fieldset class="fld_addressbook">
                <legend class="screen_out">새그룹 만들기 입력 폼</legend>
                <div class="wrap_comm">
                    <div class="box_tf">
                        <input type="text" id="tfNewGroup" name="tfNewGroup" class="tf_g"
                               title="그룹명 입력" autocomplete="off"
                               placeholder="<%- isNew ? '그룹명은 10자까지 입력할 수 있습니다.' : ''%>"
                               value="<%- group.name %>"
                               maxlength="10">
                        <button type="button" class="btn_del"><span class="ico_addressbook ico_del">삭제</span></button>
                    </div>
                </div>
                <div class="wrap_btn">
                    <button type="submit" class="btn_comm btn_type2">확인</button>
                    <button type="button" class="btn_comm btn_type1">취소</button>
                </div>
            </fieldset>
        </form>
    </div>
    <div class="layer_foot">
        <button type="button" class="btn_close"><span class="ico_addressbook ico_close">닫기</span></button>
    </div>
</script>

<script type="text/template" id="group-remove-layer-template">
    <div class="layer_alert">
        <div class="layer_head"><strong class="tit_layer">그룹삭제</strong></div>
        <div class="layer_body"><p class="desc_layer">그룹 삭제 시, 삭제할 정보를 선택해주세요.</p>
            <div class="group_radio">
                <div class="item_radio">
                    <input type="radio" id="inpDelGroup1" name="inpDelGroup" class="inp_radio" checked="" value="group">
                    <label class="lab_radio" for="inpDelGroup1">
                        <span class="ico_addressbook ico_radio"></span>그룹만 지우기
                    </label>
                </div>
                <div class="item_radio">
                    <input type="radio" id="inpDelGroup2" name="inpDelGroup" class="inp_radio" value="all">
                    <label class="lab_radio" for="inpDelGroup2">
                        <span class="ico_addressbook ico_radio"></span>그룹에 속한 연락처도 함께 지우기
                    </label>
                </div>
            </div>
            <div class="wrap_btn">
                <button type="button" class="btn_comm btn_type2">확인</button>
                <button type="button" class="btn_comm btn_type1">취소</button>
            </div>
        </div>
        <div class="layer_foot">
            <button type="button" class="btn_close"><span class="ico_addressbook ico_close">닫기</span></button>
        </div>
    </div>
</script>

<script type="text/template" id="confirm-layer-template">
    <div class="layer_alert" style="z-index: 10004;">
        <div class="layer_head"><strong class="tit_layer tit_alert"><%- data.head || '' %></strong></div>
        <div class="layer_body">
            <div class="wrap_alert">
                <p class="txt_alert">
                    <% _.each(data.messages, function(message) { %>
                    <span><%- message %><br></span>
                    <% }) %>
                </p>
            </div>
            <div class="wrap_btn">
                <button type="button" class="btn_comm btn_type2">확인</button>
                <button type="button" class="btn_comm btn_type1">취소</button>
            </div>
        </div>
        <div class="layer_foot">
            <button type="button" class="btn_close"><span class="ico_addressbook ico_close">닫기</span></button>
        </div>
    </div>
</script>

<script type="text/template" id="alert-layer-template">
    <div class="layer_alert" style="z-index: 10004;">
        <div class="layer_head"><strong class="tit_layer tit_alert"></strong></div>
        <div class="layer_body">
            <div class="wrap_alert">
                <p class="txt_alert">
                <% _.each(data.messages, function(message) { %>
                    <span><%- message %><br></span>
                <% }) %>
                </p>
            </div>
            <div class="wrap_btn">
                <button type="button" class="btn_comm btn_type2">확인</button>
            </div>
        </div>
        <div class="layer_foot">
            <button type="button" class="btn_close"><span class="ico_addressbook ico_close">닫기</span></button>
        </div>
    </div>
</script>

<script type="text/template" id="toast-layer-template">
    <div class="toast_comm" style="z-index: 100000;">
        <p class="txt_toast"><span><%- data.message %><br></span></p>
        <button type="button" class="btn_close"><span class="ico_addressbook ico_close">닫기</span></button>
    </div>
</script>

<script type="text/template" id="toast-footer-layer-template">
    <div class="toast_import toast_import2">
        <span class="ico_addressbook ico_chk"></span>
        <span class="txt_toast"><%- data.message %></span>
    <% if (data.contact) { %>
        <span class="emph_toast"><%- data.contact.importCount %> / <%- data.contact.maxCount %></span>
    <% } %>
        <button type="button" class="btn_close">
            <span class="ico_addressbook ico_close">닫기</span>
        </button>
    </div>
</script>

<script type="text/template" id="contact-list-search-template">
    <div class="wrap_tool" style="user-select: none;">
        <div class="tool_head">
            <strong class="tit_tool"><em class="emph_count">0</em>개 선택됨</strong>
            <div class="item_chk item_all">
                <input type="checkbox" id="inpChkAll" name="inpChkAll" class="inp_chk">
                <label class="lab_chk" for="inpChkAll">
                    <span class="ico_addressbook ico_chk"></span>
                </label>
            </div>
            <button type="button" class="btn_cancel">취소</button>
        </div>
        <div class="tool_body">
            <button type="button" class="btn_tool btn_modify ">
                <span class="ico_addressbook ico_modify">수정</span>
            </button>
            <div class="box_layer box_group box_open">
                <button type="button" id="move_group" class="btn_tool btn_layer">
                    <span class="ico_addressbook ico_group">그룹</span>
                    <span class="txt_btn"><%- part === 'trash' ? '복원하기' : '이동'%></span>
                </button>
                <div id="groupSettingsLayerRegion"></div>
            </div>
            <button type="submit" class="btn_tool btn_del">
                <span class="ico_addressbook ico_del"></span>
                <span class="txt_btn"><%- part === 'trash' ? '완전삭제' : '삭제'%></span>
            </button>
        </div>
        <div class="util_tool">
            <div class="box_layer box_sort" id="sort_box_layer">
                <button type="button" class="btn_layer btn_sort">
                    <span class="ico_addressbook ico_sort">정렬</span>
                    <span id="sortField" data-field="fullName">이름순</span>
                </button>
                <div class="layer_g">
                    <div class="inner_layer"><strong class="screen_out">정렬 선택 레이어</strong>
                        <ul class="list_chk">
                            <li>
                                <div class="item_chk">
                                    <input type="radio" id="inpSort1" name="inpSort" class="inp_chk" value="fullName"
                                           checked="">
                                    <label class="lab_chk" for="inpSort1">이름순<span class="ico_addressbook ico_chk"></span>
                                    </label>
                                </div>
                            </li>
                            <li>
                                <div class="item_chk">
                                    <input type="radio" id="inpSort2" name="inpSort" class="inp_chk" value="email">
                                    <label class="lab_chk" for="inpSort2">이메일순<span class="ico_addressbook ico_chk"></span>
                                    </label>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <button type="button" class="btn_order reverse_on">
                <span class="screen_out">순서변경</span>
                <span class="ico_addressbook ico_order">오름차순</span>
            </button>
        </div>
    </div>
    <div class="wrap_search"><strong class="screen_out">검색</strong>
        <form id="frmSearch" action="#">
            <fieldset class="fld_addressbook">
                <legend class="screen_out">주소록 검색폼</legend>
                <div class="box_search  ">
                    <label for="tfSearch" class="screen_out">검색어 입력</label>
                    <input maxlength="20" autocomplete="off" type="text"
                           id="tfSearch" name="tfSearch" class="tf_search" placeholder="주소록 검색">
                    <button type="button" class="btn_del">
                        <span class="ico_addressbook ico_del">삭제</span>
                    </button>
                    <button type="button" class="btn_search">
                        <span class="ico_addressbook ico_search">검색</span>
                    </button>
                </div>
            </fieldset>
        </form>
    </div>

</script>

<script type="text/template" id="contact-list-template">
    <p class="txt_notice">
        <%
            var notice = {
                recently : '최근 이용한 연락처는 최대 100일간 보관됩니다.',
                trash : '휴지통은 최대 1년간 보관됩니다. (이후 자동삭제)'
            }
        %>
        <span class="ico_addressbook ico_notice">안내</span><%- notice[part] || '연락처는 최대 2만개까지 저장할 수 있습니다.' %></p>
    <ul class="list_address list_type1"
        style="position: relative; height: 162px; will-change: transform; min-width: initial;">

<%  _.each(contactCollection.models, function(contactModel) { %>
        <li class="_vtScrollPos draggable" draggable="true" data-id="<%- contactModel.id %>">
            <div class="box_profile">
                <div class="ico_profile" area-hidden="true">
                    <%
                        var firstname = contactModel.get('firstname');
                        var firstWord = firstname.charAt(0);
                        var rgb = characterMap[firstWord.toLowerCase()]
                    %>
                    <span class="txt_profile"
                          style="background-color: <%- rgb %>"><%- firstWord.toUpperCase() %></span>
                    <svg class="ico_obj" width="540" height="540px" viewBox="0 0 540 540" version="1.1"
                         xmlns="http://www.w3.org/2000/svg">
                        <path class="ico_path"
                              d="M-30,-30 L570,-30 L570,570 L-30,570 L-30,-30 Z M0,270 C0,468.754 71.251,540 270,540 C468.754,540 540,468.754 540,270 C540,71.251 468.754,0 270,0 C71.251,0 0,78.749 0,270 Z"></path>
                    </svg>
                </div>
                <div class="item_chk item_profile">
                    <input type="checkbox" name="inpAddr" id="inpAddr<%- contactModel.id %>" class="inp_chk contact_chk"
                           value="<%- contactModel.id %>">
                    <%
                        var firstname = contactModel.get('firstname');
                        var lastname = contactModel.get('lastname');
                        var name;
                        if ( firstname && lastname) {
                            if (/^[a-zA-Z0-9]*$/.test(firstname)) {
                                name = firstname + ' ' + lastname
                            } else {
                                name = lastname + firstname
                            }
                        } else if (firstname) {
                            name = firstname;
                        } else if (lastname) {
                            name = lastname;
                        }
                    %>
                    <label class="lab_chk contact_chk" for="inpAddr<%- contactModel.id %>">
                        <span class="ico_addressbook ico_chk contact_chk"><%- name %></span>
                    </label>
                </div>
            </div>
            <div class="wrap_info">
                <div class="box_info">
                    <div class="inner_info" role="text">
                        <div class="info_address info_name">
                            <strong class="screen_out">이름</strong>
                            <span class="txt_info"><%- name %></span>
                        </div>
                        <div class="info_address info_email" role="text">
                        <% var expansions =  contactModel.get('contactExpansions'); %>
                            <strong class="screen_out">이메일</strong>
                            <span class="txt_info"><%- (expansions[0] && expansions[0].email) || '' %></span></div>
                        <div class="info_address info_phone" role="text">
                            <strong class="screen_out">전화번호</strong>
                            <span class="txt_info"><%- (expansions[0] && expansions[0].phone) || '' %></span></div>

                    <!-- 휴지통은 그룹을 표시하지 않음 -->
                    <% if ('trash' !== part ) { %>
                        <div class="info_group" role="text"><strong class="screen_out">그룹</strong>
                            <div class="wrap_bubble" id="groupsContainer-<%-contactModel.id%>">
                                <%  if (createGroupsDisplay && _.isFunction(createGroupsDisplay)) {
                                        _.each(createGroupsDisplay(contactModel.get('groups')), function($groupEL) { %>
                                            <%=  $groupEL.prop('outerHTML') %>
                                <%      });
                                    } %>
                            </div>
                        </div>
                    <% } %>
                    </div>
                </div>
            </div>

            <!-- 휴지통은 중요 연락처 설정을 표시하지 않음 -->
            <% if (part !== 'trash') { %>
            <div class="wrap_fav">
                <div class="item_chk item_fav">
                    <input type="checkbox" id="inpFav<%- contactModel.id %>" name="inpFav1" class="inp_chk"
                           value="<%- contactModel.id %>"
                           <%- contactModel.get('important') == 1 ? 'checked=checked' : '' %>>
                    <label class="lab_chk lab_fav ico_fav" for="inpFav<%- contactModel.id %>">
                        <span class="ico_addressbook ico_fav">즐겨찾기 - <%- contactModel.get('fullName') %></span>
                    </label>
                </div>
            </div>
            <% } %>

            <div class="wrap_edit" aria-hidden="true">
                <button type="button" class="btn_edit btn_modify ico_modify" value="<%- contactModel.id %>">
                    <span class="ico_addressbook ico_modify">수정</span>
                </button>
                <div class="box_layer">
                    <button type="button" class="btn_edit btn_layer ico_group" value="<%- contactModel.id %>">
                        <span class="ico_addressbook ico_group">그룹</span>
                    </button>
                </div>
                <button type="button" class="btn_edit btn_del ico_del" value="<%- contactModel.id %>">
                    <span class="ico_addressbook ico_del">삭제</span>
                </button>
            </div>
        </li>
<%  }); // _.each(contactCollection.models, function(contactModel)%>

    </ul>
</script>

<script type="text/template" id="no-search-result-template">
    <%
        var notice = {
            recently : '최근 이용한 연락처는 최대 100일간 보관됩니다.',
            trash : '휴지통은 최대 1년간 보관됩니다. (이후 자동삭제)'
        }
    %>
    <p class="txt_notice"><span class="ico_addressbook ico_notice">안내</span><%- notice[part] || '연락처는 최대 2만개까지 저장할 수 있습니다.' %></p>
    <div class="wrap_blank">
        <div class="inner_blank">
            <img src="img/blank/img_blank07.png" class="img_blank" alt="">
            <p class="desc_g">검색 결과가 없습니다.</p>
        </div>
    </div>
</script>

<script type="text/template" id="welcome-to-contacts-template">
    <%
        var notice = {
            recently : '최근 이용한 연락처는 최대 100일간 보관됩니다.',
            trash : '휴지통은 최대 1년간 보관됩니다. (이후 자동삭제)'
        }
    %>
    <p class="txt_notice"><span class="ico_addressbook ico_notice">안내</span><%- notice[part] || '연락처는 최대 2만개까지 저장할 수 있습니다.' %></p>
    <div class="wrap_blank">
        <div class="inner_blank">
            <span class="img_blank img_blank1">
                <img src="img/blank/<%- part === 'trash' ? 'img_blank02.png' : 'img_blank1_200117.png'  %>" class="thumb_g" alt="">
            </span>
        <%  if (part === 'trash') { %>
            <p class="desc_g">휴지통에 연락처가 없습니다.</p>
        <%  } else { %>
            <p class="desc_g">주소록에 오신것을 환영합니다.<br>연락처를 추가하려면 <em classname="emph_g">주소 추가</em> 버튼을 누르세요.</p></div>
        <%  } %>
    </div>
</script>

<script type="text/template" id="group-settings-template">

        <strong class="tit_layer "><%- part === 'trash' ?  '복원하기' : '그룹설정'%></strong>
        <div class="inner_layer">
            <ul class="list_chk list_chk3">
            <%
                var groups = _.map(contactModels[0].get('groups'), 'id');
                var intersection;
                if (contactModels.length > 1) {
                    for(var i = 1; i < contactModels.length; i++) {
                        intersection = _.intersection(intersection ? intersection : groups, contactModels[i].get('groups'));
                    }
                }
                _.each(groupCollection.models, function(groupModel) { %>
                <li>
                    <div class="item_chk">
                        <input type="checkbox" name="inpToolGroup" class="inp_chk"
                               id="inpToolGroup<%- groupModel.id %>" value="<%- groupModel.id %>"
                               <%- _.contains(groups, groupModel.id) ? ' checked="checked"' : '' %> />
                        <label class="lab_chk" for="inpToolGroup<%- groupModel.id %>">
                            <span class="ico_addressbook ico_group"></span><%- groupModel.get('name') %><span class="ico_addressbook ico_chk"></span>
                        </label>
                    </div>
                </li>
            <% }) %>
            </ul>
        </div>
        <button type="button" class="btn_new">
            <span class="ico_addressbook ico_new"></span>새 그룹 만들기</button>
        <button type="button" class="btn_close save">저장</button>
</script>

<script type="text/template" id="email-input-template">
    <div class="info_address" data-epicenter="email">
        <strong class="tit_info">
            <label class="lab_info" for="tfWriteMail<%- index %>">
            <% if (index === 0 ) { %>
                <span class="ico_addressbook ico_email">이메일</span>
            <% } %>
            </label>
        </strong>
        <div class="box_tf">
            <input autocomplete="off" type="text" id="tfWriteMail<%- index %>"
                   name="tfWriteMail2" class="tf_g" placeholder="이메일" title="이메일"
                   value="<%- contactExpansion.email %>">
            <button type="button" class="btn_del">
                <span class="ico_addressbook ico_del">삭제</span>
            </button>
        </div>
    <% if (index === 0 ) { %>
        <button type="button" class="btn_addition" value="email">
            <span class="ico_addressbook ico_addition">추가</span>
        </button>
    <% } %>
    </div>
</script>

<script type="text/template" id="phone-input-template">
    <div class="info_address" data-epicenter="phone">
        <strong class="tit_info">
            <label class="lab_info" for="tfWritePhone<%- index %>">
            <% if (index === 0 ) { %>
                <span class="ico_addressbook ico_phone">전화번호</span>
            <% } %>
            </label>
        </strong>
        <div class="box_info">
            <div class="box_tf">
                <%
                    var phoneType = contactExpansion.phoneType;
                    var dict = {
                        'home' : '집',
                        'company' : '직장',
                        'mobile' : '휴대폰',
                        'fax' : '팩스',
                        'etc' : '기타'
                    }
                %>
                <input autocomplete="off" type="text" id="tfWritePhone<%- index %>" name="tfWritePhone"
                       title="전화번호" class="tf_g" placeholder="전화번호"
                       value="<%- contactExpansion.phone %>" data-type="<%- phoneType || 'home' %>">
                <button type="button" class="btn_del">
                    <span class="ico_addressbook ico_del">삭제</span>
                </button>
            </div>
            <div class="opt_comm">
                <button type="button" class="btn_opt">
                    <span class="screen_out">선택됨</span>
                    <span class="selected_type"><%- dict[phoneType] || dict['home'] %></span>
                    <span class="ico_addressbook ico_arr"></span>
                </button>
                <div class="dimm_layer"></div>
                <div class="layer_g layer_opt">
                    <div class="inner_layer"><strong class="screen_out">선택옵션</strong>
                        <ul class="list_chk">
                            <li class="option">
                                <div class="item_chk">
                                    <input type="radio" id="inpOptPhone110<%- index %>" name="inpOptPhone<%- index %>"
                                           class="inp_chk" value="home" <%- !phoneType || phoneType === 'home' ? 'checked=checked' : '' %>>
                                    <label class="lab_chk" for="inpOptPhone110<%- index %>">
                                        <span><%- dict['home'] %></span>
                                        <span class="ico_addressbook ico_chk"></span>
                                    </label>
                                </div>
                            </li>
                            <li class="option">
                                <div class="item_chk">
                                    <input type="radio" id="inpOptPhone111<%- index %>" name="inpOptPhone<%- index %>"
                                           class="inp_chk" value="company" <%- phoneType === 'company' ? 'checked=checked' : '' %>>
                                    <label class="lab_chk" for="inpOptPhone111<%- index %>">
                                        <span><%- dict['company'] %></span>
                                        <span class="ico_addressbook ico_chk"></span>
                                    </label>
                                </div>
                            </li>
                            <li class="option">
                                <div class="item_chk">
                                    <input type="radio" id="inpOptPhone112<%- index %>" name="inpOptPhone<%- index %>"
                                           class="inp_chk" value="mobile" <%- phoneType === 'mobile' ? 'checked=checked' : '' %>>
                                    <label class="lab_chk" for="inpOptPhone112<%- index %>">
                                        <span><%- dict['mobile'] %></span>
                                        <span class="ico_addressbook ico_chk"></span>
                                    </label>
                                </div>
                            </li>
                            <li class="option">
                                <div class="item_chk">
                                    <input type="radio" id="inpOptPhone113<%- index %>" name="inpOptPhone<%- index %>"
                                           class="inp_chk" value="fax" <%- phoneType === 'fax' ? 'checked=checked' : '' %>>
                                    <label class="lab_chk" for="inpOptPhone113<%- index %>">
                                        <span><%- dict['fax'] %></span>
                                        <span class="ico_addressbook ico_chk"></span>
                                    </label>
                                </div>
                            </li>
                            <li class="option">
                                <div class="item_chk">
                                    <input type="radio" id="inpOptPhone114<%- index %>" name="inpOptPhone<%- index %>"
                                           class="inp_chk" value="etc" <%- phoneType === 'etc' ? 'checked=checked' : '' %>>
                                    <label class="lab_chk" for="inpOptPhone114<%- index %>">
                                        <span><%- dict['etc'] %></span>
                                        <span class="ico_addressbook ico_chk"></span>
                                    </label>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    <% if (index === 0 ) { %>
        <button type="button" class="btn_addition" value="phone">
            <span class="ico_addressbook ico_addition">추가</span>
        </button>
    <% } %>
    </div>
</script>

<script type="text/template" id="special-day-input-template">
    <div class="info_address info_more" data-epicenter="specialDay">
        <strong class="tit_info">
            <label class="lab_info" for="tfWriteDay<%- index %>">
            <% if (index === 0 ) { %>
                <span class="ico_addressbook ico_day">기념일</span>
            <% } %>
            </label>
        </strong>
        <%
            var specialDayType = contactExpansion.specialDayType;
            var dict = {
                'anniversary' : '기념일',
                'etc' : '기타'
            }
        %>
        <div class="box_info">
            <div class="box_tf">
                <input autocomplete="off" type="text" id="tfWriteDay<%- index %>" class="tf_g" name="tfWriteDay"
                       title="날짜" placeholder="날짜" value="<%- contactExpansion.specialDay %>"
                       data-type="<%- specialDayType || 'anniversary' %>">
                <button type="button" class="btn_del">
                    <span class="ico_addressbook ico_del">삭제</span>
                </button>
            </div>
            <div class="opt_comm">
                <button type="button" class="btn_opt">
                    <span class="screen_out">선택됨</span>
                    <span class="selected_type"><%- dict[specialDayType] || dict['anniversary'] %></span>
                    <span class="ico_addressbook ico_arr"></span>
                </button>
                <div class="layer_g layer_opt">
                    <div class="inner_layer">
                        <strong class="screen_out">선택옵션</strong>
                        <ul class="list_chk">
                            <li class="option">
                                <div class="item_chk">
                                    <input type="radio" id="inpOptDay1200<%- index %>" name="inpOptDay<%- index %>" class="inp_chk" checked=""
                                           value="anniversary" <%- !specialDayType || specialDayType === 'anniversary' ? 'checked=checked' : '' %>>
                                    <label class="lab_chk" for="inpOptDay1200<%- index %>">
                                        <span><%- dict['anniversary'] %></span>
                                        <span class="ico_addressbook ico_chk"></span>
                                    </label>
                                </div>
                            </li>
                            <li class="option">
                                <div class="item_chk">
                                    <input type="radio" id="inpOptDay1201<%- index %>" name="inpOptDay<%- index %>" class="inp_chk"
                                           value="etc" <%- specialDayType === 'etc' ? 'checked=checked' : '' %>>
                                    <label class="lab_chk" for="inpOptDay1201<%- index %>">
                                        <span><%- dict['etc'] %></span>
                                        <span class="ico_addressbook ico_chk"></span>
                                    </label>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="dimm_layer"></div>
            </div>
        </div>
    <% if (index === 0 ) { %>
        <button type="button" class="btn_addition" value="specialDay">
            <span class="ico_addressbook ico_addition">항목추가</span>
        </button>
    <% } %>
    </div>
</script>

<script type="text/template" id="sns-input-template">
    <div class="info_address info_more" data-epicenter="sns">
        <strong class="tit_info">
            <label class="lab_info" for="tfWriteLink<%- index %>">
            <% if (index === 0 ) { %>
                <span class="ico_addressbook ico_link">링크</span>
            <% } %>
            </label>
        </strong>

        <%
            var snsType = contactExpansion.snsType;
            var dict = {
                'blog' : '블로그',
                'homepage' : '홈페이지',
                'etc' : '기타'
            }
        %>
        <div class="box_info">
            <div class="box_tf">
                <input autocomplete="off" type="text" id="tfWriteLink<%- index %>" name="tfWriteLink"
                       class="tf_g" placeholder="http://" title="SNS"
                       value="<%- contactExpansion.sns %>" data-type="<%- snsType || 'blog' %>">
                <button type="button" class="btn_del">
                    <span class="ico_addressbook ico_del">삭제</span>
                </button>
            </div>
            <div class="opt_comm">
                <button type="button" class="btn_opt">
                    <span class="screen_out">선택됨</span>
                    <span class="selected_type"><%- dict[snsType] || dict['blog'] %></span>
                    <span class="ico_addressbook ico_arr"></span>
                </button>

                <div class="layer_g layer_opt">
                    <div class="inner_layer">
                        <strong class="screen_out">선택옵션</strong>
                        <ul class="list_chk">
                            <li class="option">
                                <div class="item_chk">
                                    <input type="radio" id="inpOptLink100<%- index %>" name="inpOptLink<%- index %>"
                                           class="inp_chk" value="blog" <%- (!snsType || snsType === 'blog') ? 'checked=checked' : '' %>>
                                    <label class="lab_chk" for="inpOptLink100<%- index %>">
                                        <span><%- dict['blog'] %></span>
                                        <span class="ico_addressbook ico_chk"></span></label>
                                </div>
                            </li>
                            <li class="option">
                                <div class="item_chk">
                                    <input type="radio" id="inpOptLink101<%- index %>" name="inpOptLink<%- index %>"
                                           class="inp_chk" value="homepage" <%- snsType === 'homepage' ? 'checked=checked' : '' %>>
                                    <label class="lab_chk" for="inpOptLink101<%- index %>">
                                        <span><%- dict['homepage'] %></span>
                                        <span class="ico_addressbook ico_chk"></span>
                                    </label>
                                </div>
                            </li>
                            <li class="option">
                                <div class="item_chk">
                                    <input type="radio" id="inpOptLink102<%- index %>" name="inpOptLink<%- index %>"
                                           class="inp_chk" value="etc" <%- snsType === 'etc' ? 'checked=checked' : '' %>>
                                    <label class="lab_chk" for="inpOptLink102<%- index %>">
                                        <span><%- dict['etc'] %></span>
                                        <span class="ico_addressbook ico_chk"></span>
                                    </label>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="dimm_layer"></div>
            </div>
        </div>
    <% if (index === 0 ) { %>
        <button type="button" class="btn_addition" value="sns">
            <span class="ico_addressbook ico_addition">추가</span>
        </button>
    <% } %>
    </div>
</script>

<script type="text/template" id="msg-input-template">
    <div class="info_address info_more" data-epicenter="msg">
        <strong class="tit_info">
            <label class="lab_info" for="tfWriteMsn<%- index %>">
            <% if (index === 0 ) { %>
                <span class="ico_addressbook ico_msn">메신저</span>
            <% } %>
            </label>
        </strong>
        <div class="box_tf">
            <input autocomplete="off" type="text" id="tfWriteMsn<%- index %>" name="tfWriteMsn" class="tf_g"
                   title="메신저" placeholder="메신저" value="<%- contactExpansion.messenger %>">
            <button type="button" class="btn_del">
                <span class="ico_addressbook ico_del">삭제</span>
            </button>
        </div>
    <% if (index === 0 ) { %>
        <button type="button" class="btn_addition" value="msg">
            <span class="ico_addressbook ico_addition">추가</span>
        </button>
    <% } %>
    </div>
</script>

<script type="text/template" id="contact-layer-group-item-template">
    <li class="group">
        <div class="item_chk">
            <input type="checkbox" id="inpWriteGroup<%- groupModel.id %>" class="inp_chk" name="inpWriteGroup"
                   value="<%- groupModel.id %>" <%- _.contains(groups, groupModel.id) ? 'checked=checked' : ''%> >
            <label class="lab_chk" for="inpWriteGroup<%- groupModel.id %>">
                <span><%- groupModel.get('name') %></span>
                <span class="ico_addressbook ico_chk"></span>
            </label>
        </div>
    </li>
</script>

<script type="text/template" id="address-input-template">
    <div class="info_address info_more" data-epicenter="address">
        <strong class="tit_info">
            <label class="lab_info" for="tfWriteLocation<%- index %>">
            <% if (index === 0 ) { %>
                <span class="ico_addressbook ico_location">주소</span>
            <% } %>
            </label>
        </strong>
        <%
            var addressType = contactExpansion.addressType;
            var dict = {
                'home' : '집',
                'company' : '직장',
                'etc' : '기타'
            }
        %>
        <div class="box_info">
            <div class="box_tf">
                <input autocomplete="off" type="text" id="tfWriteLocation<%- index %>"
                       name="tfWriteLocation" title="주소" class="tf_g" placeholder="주소"
                       value="<%- contactExpansion.address %>" data-type="<%- addressType || 'home' %>">
                <button type="button" class="btn_del">
                    <span class="ico_addressbook ico_del">삭제</span>
                </button>
            </div>
            <div class="opt_comm">
                <button type="button" class="btn_opt">
                    <span class="screen_out">선택됨</span>
                    <span class="selected_type"><%- dict[addressType] || dict['home'] %></span>
                    <span class="ico_addressbook ico_arr"></span>
                </button>
                <div class="layer_g layer_opt">
                    <div class="inner_layer"><strong class="screen_out">선택옵션</strong>
                        <ul class="list_chk">
                            <li class="option">
                                <div class="item_chk">
                                    <input type="radio" id="inpOptLocation100<%- index %>" name="inpOptLocation<%- index %>"
                                           class="inp_chk" value="home"
                                           <%- (!addressType || addressType === 'home') ? 'checked=checked' : '' %>>
                                    <label class="lab_chk" for="inpOptLocation100<%- index %>">
                                        <span><%- dict['home'] %></span>
                                        <span class="ico_addressbook ico_chk"></span>
                                    </label>
                                </div>
                            </li>
                            <li class="option">
                                <div class="item_chk">
                                    <input type="radio" id="inpOptLocation101<%- index %>" name="inpOptLocation<%- index %>"
                                           class="inp_chk" value="company"
                                           <%- addressType === 'company' ? 'checked=checked' : '' %>>
                                    <label class="lab_chk" for="inpOptLocation101<%- index %>">
                                        <span><%- dict['company'] %></span>
                                        <span class="ico_addressbook ico_chk"></span>
                                    </label>
                                </div>
                            </li>
                            <li class="option">
                                <div class="item_chk">
                                    <input type="radio" id="inpOptLocation102<%- index %>" name="inpOptLocation<%- index %>"
                                           class="inp_chk" value="etc"
                                           <%- addressType === 'etc' ? 'checked=checked' : '' %>>
                                    <label class="lab_chk" for="inpOptLocation102<%- index %>">
                                        <span><%- dict['etc'] %></span>
                                        <span class="ico_addressbook ico_chk"></span>
                                    </label>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="dimm_layer"></div>
            </div>
        </div>
    <% if (index === 0 ) { %>
        <button type="button" class="btn_addition" value="address">
            <span class="ico_addressbook ico_addition">추가</span>
        </button>
    <% } %>
    </div>
</script>

<script type="text/template" id="contact-layer-template">
    <% console.log(contact); %>
    <div class="layer_head"><strong class="screen_out">상세보기</strong></div>
    <div class="layer_body">
        <div class="address_head">
            <div class="ico_profile">
                <% var firstChar = (contact.firstname && contact.firstname[0]) && contact.firstname[0] ||
                                    (contact.lastname && contact.lastname[0]) && contact.lastname[0]; %>
                <span class="txt_profile" style="background: rgb(231, 219, 172);"><%- firstChar %></span>
                <svg class="ico_obj" width="540" height="540px" viewBox="0 0 540 540" version="1.1"
                     xmlns="http://www.w3.org/2000/svg">
                    <path class="ico_path"
                          d="M-30,-30 L570,-30 L570,570 L-30,570 L-30,-30 Z M0,270 C0,468.754 71.251,540 270,540 C468.754,540 540,468.754 540,270 C540,71.251 468.754,0 270,0 C71.251,0 0,78.749 0,270 Z"></path>
                </svg>
            </div>
            <div class="bundle_address">
                <div class="inner_bundle">
                    <div class="info_address info_name" role="text">
                        <strong class="screen_out">이름</strong>
                        <%
                            var name;
                            if ( contact.firstname && contact.lastname) {
                                if (/^[a-zA-Z0-9]*$/.test(contact.firstname)) {
                                    name = contact.firstname + ' '  + contact.lastname;
                                } else {
                                    name = contact.lastname + contact.firstname;
                                }
                            } else if (contact.firstname) {
                                name = contact.firstname;
                            } else if (contact.lastname) {
                                name = contact.lastname;
                            }
                        %>
                        <p class="txt_info"><%- name || ''%></p>
                    </div>
                    <div class="info_address info_group" role="text">
                        <strong class="screen_out">그룹</strong>
                        <div class="box_info">
                            <% _.each(contact.groups, function(group) { %>
                                <span class="ico_bubble"><%-group.name%></span>
                            <% }) %>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="address_body">
            <div class="bundle_address">
                <div class="info_address" role="text">
                    <strong class="tit_info">
                        <span class="ico_addressbook ico_name"><%-contact.nickname || ''%></span>
                    </strong>
                    <p class="txt_info"><%-contact.nickname || ''%></p>
                </div>
                <%  var expansions = _.filter(contact.contactExpansions, 'email');
                    console.log(expansions);
                    if (expansions.length === 0) { %>
                        <div class="info_address" role="text">
                            <strong class="tit_info">
                                <span class="ico_addressbook ico_email">전화</span>
                                <span class="screen_out">추가 이메일</span>
                            </strong>
                            <p class="txt_info txt_nodata">&nbsp;미입력</p>
                        </div>
                <%  } else {
                        _.each(expansions, function(expansion, i) { %>
                            <div class="info_address<%- i > 0 ? ' info_addition' : '' %>" role="text">
                                <strong class="tit_info">
                <%          if (i === 0) { %>
                                    <span class="ico_addressbook ico_email">전화</span>
                <%          } %>
                                    <span class="screen_out">추가 이메일</span>
                                </strong>
                                <p class="txt_info"><%- expansion.email %></p>
                            </div>
                <%      });
                    }

                    var phoneType = {
                        'home' : '집',
                        'company' : '직장',
                        'mobile' : '휴대폰',
                        'fax' : '팩스',
                        'etc' : '기타'
                    }
                    expansions = _.filter(contact.contactExpansions, 'phone');
                    if (expansions.length === 0) { %>
                        <div class="info_address" role="text">
                            <strong class="tit_info">
                                <span class="ico_addressbook ico_phone">전화</span>
                                <span class="screen_out">추가 전화</span>
                            </strong>
                            <p class="txt_info txt_nodata">&nbsp;미입력</p>
                        </div>
                <%  } else {
                        _.each(expansions, function(expansion, i) { %>
                            <div class="info_address<%- i > 0 ? ' info_addition' : '' %>" role="text">
                                <strong class="tit_info">
                <%          if (i === 0) { %>
                                    <span class="ico_addressbook ico_phone">전화</span>
                <%          } %>
                                    <span class="screen_out">추가 전화</span>
                                </strong>
                                <p class="txt_info"><%- expansion.phone %><span class="ico_bubble"><%- phoneType[expansion.phoneType] || phoneType['home']%></span></p>
                            </div>
                <%      });
                    }
                    if (contact.birth) { %>
                        <div class="info_address" role="text">
                            <strong class="tit_info">
                                <span class="ico_addressbook ico_birth">생일</span>
                            </strong>
                            <p class="txt_info"><%- contact.birth %></p>
                        </div>
                <%  }
                    var specialDayType = {
                        'anniversary' : '기념일',
                        'etc' : '기타'
                    }

                    _.each(contact.contactExpansions, function(expansion, i) {
                        if (!expansion.specialDay)
                            return; %>
                            <div class="info_address<%- i > 0 ? ' info_addition' : '' %>" role="text">
                                <strong class="tit_info">
                <%      if (i === 0) { %>
                                    <span class="ico_addressbook ico_day"></span>
                <%      } %>
                                </strong>
                                <p class="txt_info"><%- expansion.specialDay%><span class="ico_bubble"><%- specialDayType[expansion.specialDayType] || specialDayType['anniversary'] %></span></p>
                            </div>
                <%  });

                    var snsType = {
                        'blog' : '블로그',
                        'homepage' : '홈페이지',
                        'etc' : '기타'
                    }
                    _.each(contact.contactExpansions, function(expansion, i) {
                        if (!expansion.sns)
                            return; %>
                            <div class="info_address<%- i > 0 ? ' info_addition' : '' %>" role="text">
                                <strong class="tit_info">
                <%      if (i === 0) { %>
                                    <span class="ico_addressbook ico_link">추가 링크</span>
                <%      } %>
                                </strong>
                                <p class="txt_info">
                                    <a href="<%- expansion.sns %>" target="_blank" rel="noreferrer"><%- expansion.sns %></a>
                                    <span class="ico_bubble"><%- snsType[expansion.snsType] || snsType['blog'] %></span>
                                </p>
                            </div>
                <%  });

                    _.each(contact.contactExpansions, function(expansion, i) {
                        if (!expansion.messenger)
                            return; %>
                            <div class="info_address<%- i > 0 ? ' info_addition' : '' %>" role="text">
                                <strong class="tit_info">
                <%      if (i === 0) { %>
                                    <span class="ico_addressbook ico_msn">메신저</span>
                <%      } %>
                                </strong>
                                <p class="txt_info">MACLEAD</p>
                            </div>
                <%  });

                    var addressType = {
                        'home' : '집',
                        'company' : '직장',
                        'etc' : '기타'
                    }
                    _.each(contact.contactExpansions, function(expansion, i) {
                        if (!expansion.messenger)
                            return; %>
                            <div class="info_address<%- i > 0 ? ' info_addition' : '' %>" role="text">
                                <strong class="tit_info">
                <%      if (i === 0) { %>
                                    <span class="ico_addressbook ico_location">주소</span>
                <%      } %>
                                </strong>
                                <p class="txt_info"><%- expansion.address %><span class="ico_bubble"><%- addressType[expansion.addressType] || addressType['home'] %></span></p>
                            </div>
                <%  });

                    if (contact.organization || contact.position) { %>
                        <div class="info_address" role="text">
                            <strong class="tit_info">
                                <span class="ico_addressbook ico_office">직장</span>
                            </strong>
                            <%
                                var office;
                                if (contact.organization && contact.position)
                                    office = contact.organization +  contact.position;
                                else if (contact.organization)
                                    office  = contact.organization;
                                else if (contact.position)
                                    office = contact.position;
                            %>
                            <p class="txt_info"><%- office || '' %></p>
                        </div>
                <%  }

                    if (contact.notes) { %>
                        <div class="info_address" role="text">
                            <strong class="tit_info">
                                <span class="ico_addressbook ico_meno">메모</span>
                            </strong>
                            <p class="txt_info"><%- contact.notes %></p>
                        </div>
                <%  } %>
            </div>
        </div>
        <div class="wrap_edit">
        <% if (part !== 'trash') { %>
            <div class="item_chk item_fav">
                <input type="checkbox" id="inpViewFav" name="inpViewFav" class="inp_chk"
                       value="<%- contact.id %>" <%- contact.important === 1 ? 'checked=checked' : '' %>>
                <label class="lab_chk lab_fav" for="inpViewFav">
                    <span class="ico_addressbook ico_fav2">즐겨찾기 선택하기</span>
                </label>
            </div>

            <button type="button" class="btn_edit ico_modify2">
                <span class="ico_addressbook ico_modify2">수정</span>
            </button>
        <% } %>
            <button type="button" class="btn_edit ico_group2">
                <span class="ico_addressbook ico_group2">그룹</span>
            </button>
            <button type="button" class="btn_edit ico_del2">
                <span class="ico_addressbook ico_del2">삭제</span>
            </button>
        </div>
        <div class="group_settings_layer_region"></div>
    </div>
    <div class="layer_foot">
        <button type="button" class="btn_close">닫기</button>
    </div>
</script>

<script type="text/template" id="contact-edit-layer-template">
    <%
        var contactExpansions = contact.contactExpansions || [];
    %>
        <div class="layer_head"><strong class="tit_layer">연락처 추가</strong></div>
        <div class="layer_body">
            <form id="frmWrite" action="#">
                <fieldset class="fld_addressbook">
                    <legend class="screen_out">연락처 추가 입력 폼</legend>
                    <div class="address_body address_write">
                        <div class="bundle_address">

                            <!-- ▼▼▼ 이름 입력란 영역 시작 ▼▼▼ -->
                            <div class="info_address info_name">
                                <strong class="tit_info"><span class="ico_addressbook ico_name">이름</span></strong>
                                <div class="box_tf box_name1 ">
                                    <input autocomplete="off" type="text" id="tfWriteFirstName" name="tfWriteName"
                                           title="이름" class="tf_g" placeholder="이름(필수)"
                                           value="<%- contact.firstname %>">
                                    <button type="button" class="btn_del">
                                        <span class="ico_addressbook ico_del">삭제</span>
                                    </button>
                                </div>
                                <div class="box_tf ">
                                    <input autocomplete="off" type="text" id="tfWriteLastName" name="tfWriteName"
                                           title="성" class="tf_g" placeholder="성"
                                           value="<%- contact.lastname %>">
                                    <button type="button" class="btn_del">
                                        <span class="ico_addressbook ico_del">삭제</span>
                                    </button>
                                </div>
                                <div class="item_chk item_fav">
                                    <input type="checkbox" id="inpWriteFav" name="inpWriteFav" class="inp_chk"
                                           <%- contact.important == 1 ? 'checked=checked' : '' %>>
                                    <label class="lab_chk lab_fav" for="inpWriteFav">
                                        <span class="ico_addressbook ico_fav">즐겨찾기 선택하기</span>
                                    </label>
                                </div>
                            </div>
                            <!-- ▲▲▲ 이름 입력란 영역 끝 ▲▲▲ -->

                            <!-- ▼▼▼ 닉네임 입력란 영역 시작 ▼▼▼ -->
                            <div class="info_address info_more">
                                <strong class="tit_info">
                                    <label class="lab_info" for="tfWriteNick">
                                        <span class="ico_addressbook ico_nick">닉네임</span>
                                    </label>
                                </strong>
                                <div class="box_tf">
                                    <input autocomplete="off" type="text" id="tfWriteNick" name="tfWriteNick"
                                           title="닉네임" class="tf_g" placeholder="닉네임"
                                           value="<%- contact.nickname %>">
                                    <button type="button" class="btn_del">
                                        <span class="ico_addressbook ico_del">삭제</span>
                                    </button>
                                </div>
                            </div>
                            <!-- ▲▲▲ 닉네임 입력란 영역 끝 ▲▲▲ -->

                            <!-- ▼▼▼ 이메일 입력란 영역 시작 ▼▼▼ -->
                            <%  var expansions = _.filter(contactExpansions, 'email');
                                if (expansions.length === 0)
                                    expansions.push({});
                                _.each(expansions, function(contactExpansion, index) { %>
                                    <%= templates['email']({
                                            contactExpansion : contactExpansion,
                                            index : index
                                        }) %>
                            <%  }); %>
                            <!-- ▲▲▲ 이메일 입력란 영역 끝 ▲▲▲ -->

                            <!-- ▼▼▼ 전화번호 입력란 영역 시작 ▼▼▼ -->
                            <%  expansions = _.filter(contactExpansions, 'phone');
                                if (expansions.length === 0)
                                    expansions.push({});
                                _.each(expansions, function(contactExpansion, index) { %>
                                    <%= templates['phone']({
                                            contactExpansion : contactExpansion,
                                            index : index
                                        }) %>
                            <%  }); %>
                            <!-- ▲▲▲ 전화번호 입력란 영역 끝 ▲▲▲ -->

                            <!-- ▼▼▼ 그룹설정 입력란 영역 시작 ▼▼▼ -->
                            <div class="info_address">
                                <strong class="tit_info"><span class="ico_addressbook ico_group">그룹</span></strong>
                                <div class="opt_comm opt_group">
                                    <button title="그룹설정" type="button" class="btn_opt" value="groupSettings">
                                        <span class="screen_out">선택됨</span>
                                        <%
                                            var nameList = _.map(contact.groups, 'name');
                                            var names = nameList.length > 0 ? nameList.join(',') : '그룹설정';
                                        %>
                                        <span class="group_names"><%- names %></span>
                                        <span class="ico_addressbook ico_arr"></span>
                                    </button>
                                    <div class="layer_g layer_group layer_type3 " style="user-select: none; z-index: 1002">
                                        <strong class="tit_layer">그룹설정</strong>
                                        <div class="inner_layer">
                                            <ul class="list_chk list_chk3" id="contactLayerGroups">
                                                <% _.each(groupCollection.models, function(groupModel) {  %>
                                                    <%= templates['groupItem']({
                                                            groupModel : groupModel,
                                                            groups : _.map(contact.groups, 'id')
                                                        }) %>
                                                <%  }); %>
                                            </ul>
                                        </div>
                                        <button type="button" class="btn_new" id="showGroupCreateBox"><span
                                                class="ico_addressbook ico_new"></span>새 그룹 만들기
                                        </button>
                                        <div class="box_tf" style="padding-right: 120px; display: none" id="groupCreateBox">
                                            <input type="text" id="tfWriteGroup" name="tfWritebirth" class="tf_g"
                                                   title="그룹명" placeholder="그룹명은 10자까지 입력할 수 있습니다."
                                                   maxlength="10">
                                            <button type="button" class="btn_add">등록</button>
                                            <p class="desc_error" style="display: none">중복된 그룹명입니다.</p>
                                        </div>
                                        <button type="button" class="btn_close group_save">저장</button>
                                    </div>
                                    <div class="dimm_layer"></div>
                                </div>
                            </div>
                            <!-- ▲▲▲ 그룹설정 입력란 영역 끝 ▲▲▲-->

                            <!-- ▼▼▼ 생일 입력란 영역 시작 ▼▼▼ -->
                            <div class="info_address info_more">
                                <strong class="tit_info">
                                    <label class="lab_info" for="tfWritebirth">
                                        <span class="ico_addressbook ico_birth">생일</span>
                                    </label>
                                </strong>
                                <div class="box_tf">
                                    <input autocomplete="off" type="text" id="tfWritebirth" name="tfWritebirth"
                                           class="tf_g" placeholder="생일" title="생일"
                                           value="<%- contact.birth ? contact.birth : ''%>">
                                    <button type="button" class="btn_del">
                                        <span  class="ico_addressbook ico_del">삭제</span>
                                    </button>
                                </div>
                            </div>
                            <!-- ▲▲▲ 생일 입력란 영역 끝 ▲▲▲ -->

                            <!-- ▼▼▼ 기념일 입력란 영역 시작 ▼▼▼ -->
                            <%  expansions = _.filter(contactExpansions, 'specialDay');
                                if (expansions.length === 0)
                                    expansions.push({});
                                _.each(expansions, function(contactExpansion, index) { %>
                                    <%= templates['specialDay']({
                                            contactExpansion : contactExpansion,
                                            index : index
                                        }) %>
                            <%  }); %>
                            <!-- ▲▲▲ 기념일 입력란 영역 끝 ▲▲▲ -->

                            <!-- ▼▼▼ SNS 입력란 영역 시작 ▼▼▼ -->
                            <%  expansions = _.filter(contactExpansions, 'sns');
                                if (expansions.length === 0)
                                    expansions.push({});
                                _.each(expansions, function(contactExpansion, index) { %>
                                    <%= templates['sns']({
                                            contactExpansion : contactExpansion,
                                            index : index
                                        }) %>
                            <%  }); %>
                            <!-- ▲▲▲ SNS 입력란 영역 끝 ▲▲▲ -->

                            <!-- ▼▼▼ 메신저 입력란 영역 시작 ▼▼▼ -->
                            <%  expansions = _.filter(contactExpansions, 'messenger');
                                if (expansions.length === 0)
                                    expansions.push({});
                                _.each(expansions, function(contactExpansion, index) { %>
                                    <%= templates['msg']({
                                        contactExpansion : contactExpansion,
                                        index : index
                                    }) %>
                            <%  }); %>
                            <!-- ▲▲▲ 메신저 입력란 영역 끝 ▲▲▲ -->

                            <!-- ▼▼▼ 주소 입력란 영역 시작 ▼▼▼ -->
                            <%  expansions = _.filter(contactExpansions, 'address');
                                if (expansions.length === 0)
                                    expansions.push({});
                                _.each(expansions, function(contactExpansion, index) { %>
                                    <%= templates['address']({
                                        contactExpansion : contactExpansion,
                                        index : index
                                    }) %>
                            <%  }); %>
                            <!-- ▲▲▲ 주소 입력란 영역 끝 ▲▲▲ -->

                            <!-- ▼▼▼ 소속 입력란 영역 시작 ▼▼▼ -->
                            <div class="info_address info_more">
                                <strong class="tit_info">
                                    <label class="lab_info" for="tfWriteOffice">
                                        <span class="ico_addressbook ico_office">소속</span>
                                    </label>
                                </strong>
                                <div class="box_tf">
                                    <input type="text" id="tfWriteOffice" name="tfWriteOffice" class="tf_g" title="소속"
                                           placeholder="소속" autocomplete="off"
                                           value="<%- contact.organization ? contact.organization : ''%>">
                                    <button type="button" class="btn_del">
                                        <span class="ico_addressbook ico_del">삭제</span>
                                    </button>
                                </div>
                                <div class="box_tf">
                                    <input type="text" id="tfWriteClass" name="tfNewClass" class="tf_g" title="직위"
                                           placeholder="직위" autocomplete="off"
                                           value="<%- contact.position ? contact.position : ''%>">
                                    <button type="button" class="btn_del">
                                        <span class="ico_addressbook ico_del">삭제</span>
                                    </button>
                                </div>
                            </div>
                            <!-- ▲▲▲ 소속 입력란 영역 끝 ▲▲▲ -->

                            <!-- ▼▼▼ 메모 입력란 영역 시작 ▼▼▼ -->
                            <div class="info_address info_memo">
                                <strong class="tit_info">
                                    <label class="lab_info" for="tfWritMemo">
                                        <span class="ico_addressbook ico_meno">메모</span>
                                    </label>
                                </strong>
                                <div class="box_tf">
                                    <textarea id="tfWritMemo" name="tfWritMemo" class="tf_g" placeholder="메모"
                                              title="메모" style="min-height: 21px; resize: none; background-color: transparent; height: 21px;"><%- contact.notes %></textarea>
                                    <button type="button" class="btn_del">
                                        <span class="ico_addressbook ico_del">삭제</span>
                                    </button>
                                </div>
                            </div>
                            <!-- ▲▲▲ 메모 입력란 영역 끝 ▲▲▲ -->

                        </div>
                        <button type="button" class="btn_addition2">
                            <span class="ico_addressbook ico_addition2"></span>항목추가</button>
                        <button type="button" class="btn_more">더보기<span class="ico_addressbook ico_arr"></span>
                        </button>
                    </div>
                    <div class="wrap_btn">
                        <button type="submit" class="btn_comm btn_type2">저장</button>
                        <button type="button" class="btn_comm btn_type1" id="contactLayerCancel">
                            <span class="txt_btn">취소</span>
                            <span class="ico_addressbook ico_cancel"></span>
                        </button>
                    </div>
                </fieldset>
            </form>
        </div>
        <div class="layer_foot">
            <button type="button" class="btn_close" id="contactLayerClose">
                <span class="ico_addressbook ico_close">닫기</span>
            </button>
        </div>
</script>

<script type="text/template" id="content-layout-template">
    <div id="contactListSearchRegion"></div>
    <div id="contactListRegion"></div>
    <div id="contactLayerRegion"></div>
    <div id="contactEditLayerRegion"></div>
    <div id="importHeaderRegion"></div>
    <div id="importContentRegion" class="article_body"></div>
    <div id="importLoadingRegion"></div>
    <div id="exportHeaderRegion"></div>
    <div id="exportContentRegion" class="article_body"></div>
</script>

<script type="text/template" id="import-header-template">
    <h2>주소록 가져오기</h2>
    <div class="snb_addressbook" role="navigation"></div>
</script>

<script type="text/template" id="import-content-template">
    <div class="inner_article"><h3 class="screen_out">주소록 파일 가져오기</h3>
        <p class="desc_g">쉼표로 항목을 구분한 텍스트 파일 형식인 csv 파일을 가져와 주소록에 추가할 수 있습니다.<br>파일의 주소 개수가 1,000개 이상인 경우 속도가 느려질 수 있습니다.</p>
        <form id="frmImport" action="#">
            <fieldset>
                <legend class="screen_out">주소록 파일 가져오기 폼</legend>
                <div class="wrap_content" style="text-align: initial;">
                    <div class="inner_content" style="padding-left: 300px;">
                        <div class="box_file" style="width: 368px;">
                            <div class="box_tf">
                                <span id="fileName" class="txt_filename txt_guide">가져올 파일을 선택해주세요. (.csv 파일)</span>
                            </div>
                            <div class="btn_file">
                                <label class="lab_file" for="inpFile">파일찾기</label>
                                <input type="file" id="inpFile" name="inpFile" class="inp_file" accept=".csv">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="wrap_btn">
                    <button type="submit" class="btn_comm">가져오기</button>
                </div>
            </fieldset>
        </form>
        <div class="desc_notice"><strong class="tit_desc">꼭 확인하세요!</strong>
            <p class="txt_desc">1. 데이터는 아래와 같이 첫행에 제목 데이터가 포함되어 있어야 합니다.<br>&nbsp;&nbsp;&nbsp;(참고로, 첫행의 데이터는 제목으로 간주하여 가져오지 않습니다)</p>
            <ul class="list_desc">
                <li>Name / nickname / email / phone number / date of birth / anniversary / SNS / messenger / address / company / title / memo</li>
            </ul>
            <p class="txt_desc">2. 아래의 항목은 숫자를 넣어 데이터를 추가할수 있습니다.<br>&nbsp;&nbsp;&nbsp;(단, 추가하는 항목은
                이메일/전화번호/기념일/SNS/메신저/주소 항목 모두 합하여 30개까지만 가능합니다.)</p>
            <ul class="list_desc">
                <li>Email : email 1 / email 2 / email 3 ...</li>
                <li>Phone number : phone number 1 / phone number 2 / phone number 3 ...</li>
                <li>Anniversary : anniversary 1 / anniversary 2 / anniversary 3 ...</li>
                <li>SNS : SNS 1 / SNS 2 / SNS 3 ...</li>
                <li>Messenger : messenger 1 /messenger 2 / messenger 3 ...</li>
                <li>Address: address 1 / address 2 / address 3 ...</li>
            </ul>
            <p class="txt_desc">3. 아래의 항목은 쉼표(,)를 이용하여 아래의 타입을 입력할수 있습니다. (입력예시 : 010-1234-5678, 핸드폰)<br>&nbsp;&nbsp;&nbsp;&nbsp;만약,
                해당 요소가 없다면 가장 첫번째 타입을 기본 타입으로 지정하여 업데이트 됩니다. (선택박스 중 첫번째 노출되는 타입과 동일함)</p>
            <ul class="list_desc">
                <li>Phone number : Select 1 from Home / Work / Mobile phone / Fax / Other</li>
                <li>Address : Select 1 from Home / Work / Other</li>
                <li>Anniversary : Select 1 from Anniversary / Other</li>
                <li>SNS : Select 1 from Blogs / Homepages / Other</li>
            </ul>
            <p class="txt_desc">4. 일부 특수문자의 경우 가져오기 시 누락될수 있습니다.</p>
            <p class="txt_desc">5. 가져오기할 데이터가 없을 경우는 열을 비워두셔야 데이터 입력에 혼선이 생기지 않습니다.</p>
            <div class="wrap_btn">
                <button type="button" class="btn_comm btn_type1" id="sampleFile">
                    <span class="ico_addressbook ico_download"></span>샘플 파일
                    다운로드
                </button>
            </div>
        </div>
    </div>


</script>

<script type="text/template" id="import-loading-template">
    <div class="layer_alert layer_loading2">
        <div class="layer_body">
            <div class="wrap_alert">
                <span class="ico_loading">
                    <img src="img/ico_loading.png" class="thumb_g" alt="">
                </span>
                <span class="txt_loading">주소록을 가져오는 중입니다.</span>
                <span class="desc_loading">0 / <%- data.maxCount %></span></div>
            <div class="wrap_btn">
                <button type="button" class="btn_comm btn_type1">취소</button>
            </div>
        </div>
    </div>
</script>

<script type="text/template" id="export-header-template">
    <h2>주소록 내보내기</h2>
</script>

<script type="text/template" id="export-content-template">
    <div class="inner_article">
        <p class="desc_g">쉼표로 항목을 구분한 텍스트 파일 형식인 csv 파일로 주소록 내보내기가 가능합니다.<br>csv 파일은 아웃룩, 익스프레스에서 이용할 수 있습니다.</p>
        <div class="wrap_content wrap_export">
            <div class="inner_content">
                <p class="txt_export">내보내기 버튼 클릭 시, 내 PC로 파일이 다운로드 됩니다.</p>
                <button type="button" class="btn_comm btn_export">내보내기</button>
            </div>
        </div>
    </div>
</script>
